<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.koitt.tim.dao.review.ReviewDao">

    <select id="selectReviewList" resultType="com.koitt.tim.dto.review.ReviewDto">
        select r."review_num", "id", "title", "regist_review", "hit", "score", "content", "image", "admin_answer"
        from REVIEW r,ORDER_LIST o
        where r."Key"=o.KEY and o."pro_num"=#{pro_num}
    </select>

    <insert id="insertReview">
        insert into REVIEW
        values (REVIEW_SEQ.nextval,#{id},'2020060306',#{title},sysdate,'0',#{star},#{content},null,null,#{pro_num})
    </insert>



	<!--  admin 모든 리뷰 불러오기 -->
	<select id="selectAllReview" resultType="ReviewDto">
		select * from review order by "regist_review" desc
	</select>
	
	<!--  리뷰 답변 입력 -->
	<update id="updateReviewAnswerA">
		update review set "admin_answer"=#{param2} where "review_num"=#{param1}
	</update>
	
	<!--  리뷰답변 삭제 -->
	<update id="updateReviewAnswerD">
		update review set "admin_answer"=null where "review_num"=#{param1}
	</update>
	
	<!-- 리뷰 상품정보(이름과 수량) -->
	<select id="reviewProductNQ" resultType="map">
	select ol."o_quant", ol.product_name 
	from order_list ol, 
	review r where ol."KEY" = r."Key" and r."review_num" = #{param1}
	</select>
</mapper>